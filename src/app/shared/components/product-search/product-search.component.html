<div class="search-container"  appOutSideClick
     (outsideClick)="handleOutsideClick()" >
  <form class="search-bar" #searchForm=ngForm>
    <input
      type="text"
      name="searchTerm"
      autocomplete="off"
      ngModel
      placeholder="Search products. Ex: iPhone"
    />
    <div class="search-icon" *ngIf="!isLoading && !searchForm.value.searchTerm">
      <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#5f6368">
        <path d="M0 0h24v24H0z" fill="none" />
        <path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zM9.5 14C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/>
      </svg>
    </div>
    <div class="search-icon" *ngIf="!isLoading && searchForm.value.searchTerm" style="cursor: pointer" (click)="onClear()">
      <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" fill="#5f6368"><path d="M0 0h24v24H0z" fill="none"/><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
    </div>
    <div class="search-icon" *ngIf="isLoading">
      <span class="loader"></span>
    </div>
  </form>

  <div class="search-results" [ngClass]="{'has-results': searchProducts.length > 0}">
    <div class="search-item" *ngFor="let item of searchProducts" (click)="onSelectItem(item)">
      <img [src]="item.images && item.images.length ? item.images[0] : ''" alt="product image" />
      <div class="item-info">
        <h3>{{ item.name }}</h3>
        <p>Category: {{ item.category?.name }} > {{ item.subCategory?.name }}</p>
        <div class="price-info">
          <span class="discounted-price">{{ item.salePrice }}</span>
          <span class="original-price">{{ item.salePrice }}</span>
        </div>
      </div>
      <div class="stock-info" *ngIf="item.quantity">In Stock: {{ item.quantity }}pcs</div>
      <div *ngIf="!item.quantity && item.variationList?.length" class="custom-variation-list-design">
        <div *ngFor="let variation of item.variationList" class="stock-info">
          In Stock: {{variation?.name}} : {{ variation.quantity }} pcs
        </div>
      </div>
    </div>
  </div>
</div>
