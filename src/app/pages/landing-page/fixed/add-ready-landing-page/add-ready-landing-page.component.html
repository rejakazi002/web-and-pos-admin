<div class="container">

  <div class="content add-page">
    <form #formElement="ngForm" [formGroup]="dataForm" (ngSubmit)="onSubmit()" autocomplete="off">


      <div class="product-search-area">
        <div class="title">
          <h3>Product:</h3>
        </div>
        <app-product-search (onSelect)="onProductSelect($event)"></app-product-search>
      </div>

      <div class="product-area">
        <div class="search-results" [ngClass]="{'has-results': allTableData?.length > 0}">
          <div class="search-item" *ngFor="let p of allTableData; let i = index">
            <img [src]="p?.images && p?.images?.length ? p?.images[0] : ''" alt="product image"/>
            <div class="item-info">
              <h3>{{ p?.name }}</h3>
              <p>Category: {{ p?.category?.name }} > {{ p?.subCategory?.name }}</p>
              <div class="price-info">
                <span class="discounted-price">{{ p?.salePrice }}</span>
                <span class="original-price">{{ p?.salePrice }}</span>
              </div>
            </div>
            <div class="stock-info" *ngIf="p?.quantity">In Stock: {{ p?.quantity }}pcs</div>
            <div *ngIf="!p?.quantity && p?.variationList?.length" class="custom-variation-list-design">
              <div *ngFor="let variation of p.variationList" class="stock-info">
                In Stock: {{ variation?.name }} : {{ variation.quantity }} pcs
              </div>
            </div>
            <button type="button" class="remove-btn" (click)="deleteProduct(i)">
              <mat-icon>close</mat-icon>
            </button>
          </div>
        </div>
      </div>


      <div class="gallery-picker">
        <app-gallery-image-picker
          [type]="'multiple'"
          [maxImages]="1"
          [isInvalid]="this.dataForm.get('images').touched && this.dataForm.get('images').invalid"
          (onPicked)="onPickedImage($event,'image')"
          infoText="This  image for top section (950px * 350px)"
          [images]="pickedImages">
        </app-gallery-image-picker>
      </div>

      <div class="custom-date-picker">

        <div class="close-date-picker">
          <svg *ngIf="dataForm.get('endDate')?.value" (click)="resetDate()" matTooltip="Remove Date" width="25px" height="25px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
            <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
            <g id="SVGRepo_iconCarrier">
              <path fill-rule="evenodd" clip-rule="evenodd"
                    d="M5.29289 5.29289C5.68342 4.90237 6.31658 4.90237 6.70711 5.29289L12 10.5858L17.2929 5.29289C17.6834 4.90237 18.3166 4.90237 18.7071 5.29289C19.0976 5.68342 19.0976 6.31658 18.7071 6.70711L13.4142 12L18.7071 17.2929C19.0976 17.6834 19.0976 18.3166 18.7071 18.7071C18.3166 19.0976 17.6834 19.0976 17.2929 18.7071L12 13.4142L6.70711 18.7071C6.31658 19.0976 5.68342 19.0976 5.29289 18.7071C4.90237 18.3166 4.90237 17.6834 5.29289 17.2929L10.5858 12L5.29289 6.70711C4.90237 6.31658 4.90237 5.68342 5.29289 5.29289Z"
                    fill="#0F1729"></path>
            </g>
          </svg>
        </div>


        <mat-form-field appearance="outline">
          <mat-label>Offer End Date</mat-label>
          <input readonly (click)="picker2.open()" formControlName="endDate" matInput [matDatepicker]="picker2"
                 placeholder="Choose date">
          <mat-datepicker-toggle matSuffix [for]="picker2"></mat-datepicker-toggle>
          <mat-datepicker #picker2></mat-datepicker>
        </mat-form-field>
      </div>
      <!--      <div class="gallery-picker">-->
      <!--        <app-gallery-image-picker-->
      <!--          [type]="'multiple'"-->
      <!--          [maxImages]="2"-->
      <!--          [isInvalid]="this.dataForm.get('reviewScreenShoot').touched && this.dataForm.get('reviewScreenShoot').invalid"-->
      <!--          (onPicked)="onPickedImage($event,'reviewScreenShoot')"-->
      <!--          infoText="This  images for review Screenshot"-->
      <!--          [images]="certificateImage">-->
      <!--        </app-gallery-image-picker>-->
      <!--      </div>-->

<!--      <mat-form-field appearance="outline">-->
<!--        <mat-label>Top Slide Text</mat-label>-->
<!--        <input formControlName="whyBuy" matInput placeholder="Enter slide text">-->
<!--        <mat-error>This field is required</mat-error>-->
<!--      </mat-form-field>-->

      <mat-form-field appearance="outline">
        <mat-label>Title</mat-label>
        <input formControlName="name" matInput placeholder="Enter title" required>
        <mat-error>This field is required</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" *ngIf="id">
        <mat-label>Slug</mat-label>
        <input formControlName="slug" matInput placeholder="Enter slug">
        <mat-error>This field is required</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline" class="w-100 px-1">
        <mat-label>Description</mat-label>
        <textarea formControlName="description" matInput placeholder="Enter image url" [rows]="6"></textarea>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Enter Video Title</mat-label>
        <input formControlName="offerText" matInput placeholder="Enter text">
        <mat-error>This field is required</mat-error>
      </mat-form-field>

      <mat-form-field appearance="outline">
        <mat-label>Enter youtube Url</mat-label>
        <input formControlName="videoUrl" matInput placeholder="Enter url">
        <mat-error>This field is required</mat-error>
      </mat-form-field>


      <!--      <div class="description-area">-->
      <!--        <label>Description</label>-->
      <!--        <div class="description-main">-->
      <!--          <app-html-editor  formControlName="description"></app-html-editor>-->
      <!--        </div>-->
      <!--      </div>-->
      <mat-card class="w-100 px-1" style="margin-top: 20px">
        <div class="title">
          <h4>Product offer Information</h4>
        </div>

        <div>
          <!--            <mat-form-field appearance="outline" class="w-100 px-1">-->
          <!--              <mat-label>Product info title</mat-label>-->
          <!--              <input formControlName="productDetailsTitle" matInput placeholder="Enter title">-->
          <!--              <mat-error>This field is required</mat-error>-->
          <!--            </mat-form-field>-->

          <div class="description-main">
            <app-html-editor formControlName="productDetailsTitle"></app-html-editor>
          </div>
        </div>


        <div class="form-array-container">
          <div class="add-form-array-action" style="margin-top: 10px">
            <button class="add-product-btn" type="button" mat-button color="primary"
                    (click)="onAddProductInfo('productDetails')">
              <mat-icon>add</mat-icon>
              Add New ProductDetails
            </button>
          </div>
          <div formArrayName="productDetails" class="form-array-input">
            <div class="single-field"
                 *ngFor="let data of productDetailsDataArray?.controls; let i = index"
                 [formGroupName]="i">

              <app-gallery-image-picker
                [type]="'multiple'"
                [maxImages]="1"
                [isInvalid]="data.get('image')?.touched && data.get('image')?.invalid"
                (onPicked)="onPickedProductDetails($event, i)"
                infoText="The image for any (154px * 100px)"
                [images]="dataForm.value.productDetails[i].image ? [dataForm.value.productDetails[i].image] : []">
              </app-gallery-image-picker>
              <div class="desc">
                <mat-form-field appearance="outline">
                  <mat-label>Title</mat-label>
                  <textarea formControlName="name" matInput [placeholder]="'Enter title ' + i + 1" type="text"
                            [rows]="1"></textarea>
                </mat-form-field>

                <button type="button" mat-mini-fab color="warn" (click)="removeFormArrayField('productDetails', i)">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </div>
          </div>
        </div> <!-- END PHONES FORM ARRAY -->

      </mat-card>

      <mat-card class="w-100 px-1">
        <div class="title">
          <h4>Benefit</h4>
        </div>

        <div>
          <mat-form-field appearance="outline" class="w-100 px-1">
            <mat-label>Benefit Title</mat-label>
            <input formControlName="title" matInput placeholder="Enter title">
            <mat-error>This field is required</mat-error>
          </mat-form-field>
        </div>

        <!--        <div class="gallery-picker">-->
        <!--          <app-gallery-image-picker-->
        <!--            [type]="'multiple'"-->
        <!--            [maxImages]="1"-->
        <!--            [isInvalid]="this.dataForm.get('specificationImage').touched && this.dataForm.get('specificationImage').invalid"-->
        <!--            (onPicked)="onPickedImage($event,'specificationImage')"-->
        <!--            infoText="The  image for any (1080px * 1080px)"-->
        <!--            [images]="specificationImage">-->
        <!--          </app-gallery-image-picker>-->
        <!--        </div>-->

        <div class="form-array-container">
          <div class="add-form-array-action">
            <button class="add-product-btn" type="button" mat-button color="primary"
                    (click)="onAddNewShopObject('specifications')">
              <mat-icon>add</mat-icon>
              Add New Benefit
            </button>
          </div>
          <div formArrayName="specifications" class="form-array-input">
            <div class="single-field"
                 *ngFor="let data of specificationDataArray?.controls; let i = index"
                 [formGroupName]="i">
              <!--              <mat-form-field appearance="outline">-->
              <!--                <mat-label>Title</mat-label>-->
              <!--                <input formControlName="title" matInput/>-->
              <!--                <mat-error>This field is required.</mat-error>-->
              <!--              </mat-form-field>-->
              <div class="desc">
                <!--                <mat-form-field appearance="outline">-->
                <!--                  <mat-label>Description</mat-label>-->
                <!--                  &lt;!&ndash;            <input formControlName="value" matInput [placeholder]="'Enter Description ' + i + 1" type="text">&ndash;&gt;-->
                <!--                  <textarea formControlName="value" matInput [placeholder]="'Enter Description ' + i + 1" type="text" [rows]="1"></textarea>-->
                <!--                </mat-form-field>-->
                <mat-form-field appearance="outline">
                  <mat-label>Title</mat-label>
                  <input formControlName="title" matInput/>
                  <mat-error>This field is required.</mat-error>
                </mat-form-field>

                <button type="button" mat-mini-fab color="warn" (click)="removeFormArrayField('specifications', i)">
                  <mat-icon>delete</mat-icon>
                </button>
              </div>
            </div>
          </div>
        </div> <!-- END PHONES FORM ARRAY -->

      </mat-card>


      <mat-card class="w-100 px-1" style="margin-top: 20px">
        <div class="title">
          <h4>Why Buy</h4>
        </div>

        <div>
          <mat-form-field appearance="outline" class="w-100 px-1">
            <mat-label>Why Buy Title</mat-label>
            <input formControlName="whyBestTitle" matInput placeholder="Enter title" required>
            <mat-error>This field is required</mat-error>
          </mat-form-field>
        </div>
<!--        <mat-form-field appearance="outline" class="w-100 px-1">-->
<!--          <mat-label>Description</mat-label>-->
<!--          <textarea formControlName="whyBestDescription" matInput placeholder="Enter image url" [rows]="6"></textarea>-->
<!--        </mat-form-field>-->

        <div class="description-main">
          <app-html-editor formControlName="whyBestDescription"></app-html-editor>
        </div>
      </mat-card>
<!--        <div class="gallery-picker" style="margin-top: 20px;">-->
<!--          <app-gallery-image-picker-->
<!--            [type]="'multiple'"-->
<!--            [maxImages]="1"-->
<!--            [isInvalid]="this.dataForm.get('specificationImage').touched && this.dataForm.get('specificationImage').invalid"-->
<!--            (onPicked)="onPickedImage($event,'specificationImage')"-->
<!--            infoText="The  image for any (1080px * 1080px)"-->
<!--            [images]="specificationImage">-->
<!--          </app-gallery-image-picker>-->
<!--        </div>-->


<!--        <mat-card class="w-100 px-1" style="margin-top: 20px;">-->
<!--          <div class="title">-->
<!--            <h4>Faq</h4>-->
<!--          </div>-->

<!--          <div>-->
<!--            <mat-form-field appearance="outline" class="w-100 px-1">-->
<!--              <mat-label>Faq Title</mat-label>-->
<!--              <input formControlName="faqTitle" matInput placeholder="Enter title">-->
<!--              <mat-error>This field is required</mat-error>-->
<!--            </mat-form-field>-->
<!--          </div>-->


<!--          <div class="form-array-container">-->
<!--            <div class="add-form-array-action" style="margin-top: 10px">-->
<!--              <button class="add-product-btn" type="button" mat-button color="primary" (click)="onAddNewFaq('faqList')">-->
<!--                <mat-icon>add</mat-icon>-->
<!--                Add New Faq-->
<!--              </button>-->
<!--            </div>-->
<!--            <div formArrayName="faqList" class="form-array-input">-->
<!--              <div class="single-field"-->
<!--                   *ngFor="let data of faqDataArray?.controls; let i = index"-->
<!--                   [formGroupName]="i">-->
<!--                <mat-form-field appearance="outline">-->
<!--                  <mat-label>Question</mat-label>-->
<!--                  <input formControlName="question" matInput/>-->
<!--                  <mat-error>This field is required.</mat-error>-->
<!--                </mat-form-field>-->
<!--                <div class="desc">-->
<!--                  <mat-form-field appearance="outline">-->
<!--                    <mat-label>Description</mat-label>-->
<!--                    <textarea formControlName="answer" matInput [placeholder]="'Enter answer ' + i + 1" type="text"-->
<!--                              [rows]="1"></textarea>-->
<!--                  </mat-form-field>-->

<!--                  <button type="button" mat-mini-fab color="warn" (click)="removeFormArrayField('faqList', i)">-->
<!--                    <mat-icon>delete</mat-icon>-->
<!--                  </button>-->
<!--                </div>-->
<!--              </div>-->
<!--            </div>-->
<!--          </div> &lt;!&ndash; END PHONES FORM ARRAY &ndash;&gt;-->

<!--        </mat-card>-->

        <!--      </mat-card>-->
        <mat-card class="w-100 px-1" style="margin-top: 20px">
          <div class="title">
            <h4>Review Title</h4>
          </div>

          <div>
<!--            <mat-form-field appearance="outline" class="w-100 px-1">-->
<!--              <mat-label>Review Title</mat-label>-->
<!--              <input formControlName="reviewTitle" matInput placeholder="Enter title">-->
<!--              <mat-error>This field is required</mat-error>-->
<!--            </mat-form-field>-->

            <div class="description-main">
              <app-html-editor formControlName="reviewTitle"></app-html-editor>
            </div>
          </div>


          <div class="form-array-container">
            <div class="add-form-array-action" style="margin-top: 10px">
              <button class="add-product-btn" type="button" mat-button color="primary" (click)="onAddReview('reviews')">
                <mat-icon>add</mat-icon>
                Add New Review
              </button>
            </div>
            <div formArrayName="reviews" class="form-array-input">
              <div class="single-field"
                   *ngFor="let data of reviewsDataArray?.controls; let i = index"
                   [formGroupName]="i">

                <app-gallery-image-picker
                  [type]="'multiple'"
                  [maxImages]="1"
                  [isInvalid]="data.get('image')?.touched && data.get('image')?.invalid"
                  (onPicked)="onPickedReview($event, i)"
                  infoText="The image for any (154px * 100px)"
                  [images]="dataForm.value.reviews[i].image ? [dataForm.value.reviews[i].image] : []">
                </app-gallery-image-picker>

                <mat-form-field appearance="outline">
                  <mat-label>Customer Name</mat-label>
                  <input formControlName="name" matInput/>
                  <mat-error>This field is required.</mat-error>
                </mat-form-field>

<!--                <mat-form-field appearance="outline">-->
<!--                  <mat-label>Rating</mat-label>-->
<!--                  <input formControlName="rating" matInput type="number"/>-->
<!--                  <mat-error>This field is required.</mat-error>-->
<!--                </mat-form-field>-->

<!--                <div class="desc">-->
<!--                  <mat-form-field appearance="outline">-->
<!--                    <mat-label>Write Review</mat-label>-->
<!--                    <textarea formControlName="review" matInput [placeholder]="'Enter review ' + i + 1" type="text"-->
<!--                              [rows]="1"></textarea>-->
<!--                  </mat-form-field>-->

<!--                  <button type="button" mat-mini-fab color="warn" (click)="removeFormArrayField('reviews', i)">-->
<!--                    <mat-icon>delete</mat-icon>-->
<!--                  </button>-->
<!--                </div>-->
              </div>
            </div>
          </div> <!-- END PHONES FORM ARRAY -->

        </mat-card>



        <mat-card class="w-100 px-1" style="margin-top: 20px">
          <div class="title">
            <h4>Why Buy and Why Best</h4>
          </div>

          <div class="description-area">
            <!--          <label>Description</label>-->
            <div class="description-main">
              <app-html-editor formControlName="whyBuyDescription"></app-html-editor>
            </div>
          </div>

        </mat-card>
<!--        <mat-card class="w-100 px-1" style="margin-top: 20px">-->
<!--          <mat-form-field appearance="outline" class="w-100 px-1">-->
<!--            <mat-label>Payment section Title</mat-label>-->
<!--            <input formControlName="paymentTitle" matInput placeholder="Enter title">-->
<!--            <mat-error>This field is required</mat-error>-->
<!--          </mat-form-field>-->
<!--        </mat-card>-->

      <div>
        <div class="title">
          <h4>Payment section Title</h4>
        </div>
        <div class="description-main">
          <app-html-editor formControlName="paymentTitle"></app-html-editor>
        </div>
      </div>


<!--        <mat-form-field appearance="outline">-->
<!--          <mat-label>Background Color</mat-label>-->
<!--          <input formControlName="backgroundColor" matInput placeholder="Ex- #000000">-->
<!--          <mat-error>This field is required</mat-error>-->
<!--        </mat-form-field>-->

<!--        <mat-form-field appearance="outline">-->
<!--          <mat-label>Text Color</mat-label>-->
<!--          <input formControlName="textColor" matInput placeholder="Ex- #000000">-->
<!--          <mat-error>This field is required</mat-error>-->
<!--        </mat-form-field>-->

<!--        <mat-form-field appearance="outline">-->
<!--          <mat-label>Products Header Title</mat-label>-->
<!--          <input formControlName="productHeaderTitle" matInput placeholder="Ex- Product Shown in the Image">-->
<!--          <mat-error>This field is required</mat-error>-->
<!--        </mat-form-field>-->


        <div class="d-row">
          <mat-form-field appearance="outline">
            <mat-label>Status</mat-label>
            <mat-select formControlName="status">
              @for (data of dataStatus; track data.value) {
                <mat-option [value]="data.value">
                  {{ data.viewValue }}
                </mat-option>
              }
            </mat-select>
            <mat-error>This field is required.</mat-error>
          </mat-form-field>
        </div> <!-- END! d-row -->


        <div class="action">
          <button (click)="onDiscard()" mat-stroked-button color="warn" type="button" class="discard">
            <mat-icon>arrow_back_ios</mat-icon>
            Discard
          </button>

          <button (click)="onPreview()" mat-stroked-button color="primary" type="button" class="preview">
            <mat-icon>visibility</mat-icon>
            Preview
          </button>

          @if (!isLoading) {
            <button mat-button class="add-product-btn" color="primary" type="submit">
              <mat-icon>check</mat-icon>
              {{ id ? 'Update OfferPage' : 'Add OfferPage' }}
            </button>
          } @else {
            <button class="btn-loader" mat-button type="button" color="primary">
              <div><span class="loader"></span></div>
              <div><span class="txt">{{ id ? 'Update OfferPage' : 'Add OfferPage' }}</span></div>
            </button>
          }
        </div> <!-- END! action -->

    </form> <!-- END! form -->
  </div> <!-- END! content -->
</div> <!-- END! container -->
